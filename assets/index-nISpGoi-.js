import{r as d,j as t}from"./react-CWupyEIp.js";import{c as Ee}from"./react-dom-VCwjLMmb.js";import{u as z,a as D,s as U,P as Le}from"./react-redux-lufdH4nZ.js";import{i as de}from"./i18next-CIEwNdMy.js";import{B as Fe}from"./i18next-browser-languagedetector-RoqpcJAD.js";import{i as H,a as ue,p as ce,b as pe,c as Me,d as ze}from"./lodash-D2vEjal1.js";import{a as me}from"./js-cookie-Cz0CWeBA.js";import{i as Ge,u as F}from"./react-i18next-BrwsTrR0.js";import{c as V,a as Ue}from"./@reduxjs-DYdxbMDp.js";import{t as Ae}from"./redux-thunk-ClJT1hhx.js";import{H as Be}from"./react-router-dom-CjmWq2Hl.js";import{c as Q}from"./tailwindcss-BDwuR9Gb.js";import{P as s}from"./prop-types-CQ0OIHYe.js";import{i as Pe,p as te,E as He,F as Ke}from"./react-contexify-DUBhUkXT.js";import{F as We,a as Qe,b as Ye,c as Je,M as Ve,G as Ze,d as Xe,e as et,f as tt,g as rt,h as ot,i as nt}from"./react-icons-vW0pnGRI.js";import{C as ae,R as at}from"./pretty-checkbox-react-DrXb9Xoa.js";import{_ as st}from"./react-spinners-BdeI7hdQ.js";import{d as re}from"./chinese-conv-CbsDIUcB.js";import{C as ge}from"./clipboard-vqTQgCbH.js";import{t as ct}from"./html-to-image-Cnhg7C0r.js";import{h as it}from"./moment-C5S46NFB.js";/* empty css                 */import"./scheduler-CzFDRTuY.js";import"./use-sync-external-store-DpKzF1FG.js";import"./redux-DITMfSWq.js";import"./immer-AZmEbvJU.js";import"./reselect-DyB87yl0.js";import"./react-router-D0a0eGYo.js";import"./@remix-run-ByPv_JRW.js";import"./picocolors-CBpy9uNM.js";import"./clsx-CH7BE6MN.js";import"./react-merge-refs-BIBY5Z5W.js";import"./nanoid-Cpg-fJ3N.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function c(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(o){if(o.ep)return;o.ep=!0;const n=c(o);fetch(o.href,n)}})();const lt=(a="",e=null)=>{!a&&!e||me.set(a,e,{expires:365})},Y=(a="")=>me.get(a),dt="formation × share",ut="Mythic",pt="Exalted",mt="Legend",gt="Other",ht="Warrior",bt="Defender",ft="Magician",yt="Supporter",xt="Star",kt="Name",wt="Normal",$t="Show",vt="Bold",qt="Please enter a keyword",Ct="Reverse",jt="Reset",Nt="TurnOrder",St="CopyLink",Tt="Download",Rt="Select the mercenary list, and click the formation. Or just drag and drop.",Dt="Drag the mercenary in the grid to change the position.",It="Right click can set skill enhancement level.",_t="Double-click or drag to the right to remove the mercenaries in the grid.",Ot="Click [turnorder] to setup priority.",Et="Click [download] to get image or [copylink] get share link.",Lt={title:dt,mythic:ut,exalted:pt,legend:mt,other:gt,attacker:ht,defender:bt,magician:ft,supporter:yt,star:xt,name:kt,normal:wt,show:$t,bold:vt,search:qt,"show-content":"Content","mercenary-type":"Type","mercenary-queue":"Queue","background-color":"Bg Color","background-grid":"Bg Grid",reverse:Ct,"image-width":"Width","image-width-custom":"Custom:",reset:jt,queue:Nt,copylink:St,download:Tt,tip1:Rt,tip2:Dt,tip3:It,tip4:_t,tip5:Ot,tip6:Et,"browser-mobile-alert":"The desktop is better than the mobile."},Ft="mercenario × compartir",Mt="Mítico",zt="Exaltado",Gt="Leyenda",Ut="Otro",At="Guerrero",Bt="Defensor",Pt="Mago",Ht="Soporte",Kt="estrella",Wt="Nombre",Qt="Normal",Yt="Mostrar",Jt="Negrita",Vt="Por favor ingrese una palabra clave",Zt="Inversa",Xt="Reiniciar",er="Giro",tr="CopiarLink",rr="Descargar",or="Seleccione la lista de mercenarios y haga clic en la formación. O simplemente arrastrar y soltar.",nr="Arrastre el mercenario en la cuadrícula para cambiar la posición.",ar="El clic derecho puede establecer el nivel de mejora de habilidades.",sr="Haga doble clic o arrastre hacia la derecha para eliminar los mercenarios en la cuadrícula.",cr="Haga clic en [giro] para configurar la prioridad.",ir="Haga clic en [descargar] para obtener la imagen o [copylink] obtener el enlace para compartir.",lr={title:Ft,mythic:Mt,exalted:zt,legend:Gt,other:Ut,attacker:At,defender:Bt,magician:Pt,supporter:Ht,star:Kt,name:Wt,normal:Qt,show:Yt,bold:Jt,search:Vt,"show-content":"Contenido","mercenary-type":"Tipo","mercenary-queue":"Cola","background-color":"Color","background-grid":"Cuadrícula",reverse:Zt,"image-width":"Anchura","image-width-custom":"otro:",reset:Xt,queue:er,copylink:tr,download:rr,tip1:or,tip2:nr,tip3:ar,tip4:sr,tip5:cr,tip6:ir,"browser-mobile-alert":"El escritorio es mejor que el móvil."},dr="formation × teilen",ur="Mythisch",pr="Erhaben",mr="Legende",gr="Andere",hr="Krieger",br="Verteidiger",fr="Magier",yr="Unterstützer",xr="Star",kr="Name",wr="Normal",$r="Show",vr="Fett",qr="Bitte geben Sie ein Schlüsselwort ein",Cr="Umkehren",jr="Neu",Nr="TurnOrder",Sr="LinkKopieren",Tr="Herunterladen",Rr="Wählen Sie die Söldnerliste aus und klicken Sie auf die Formation. Oder einfach per Drag & Drop.",Dr="Ziehen Sie den Söldner in das Raster, um die Position zu ändern.",Ir="Ein Rechtsklick kann die Fähigkeitsverbesserungsstufe festlegen.",_r="Doppelklicken oder ziehen Sie nach rechts, um die Söldner im Raster zu entfernen.",Or="Klicken Sie auf [turnorder], um die Priorität festzulegen.",Er="Klicken Sie auf [download], um ein Bild zu erhalten, oder auf [copylink], um den Link zum Teilen zu erhalten.",Lr={title:dr,mythic:ur,exalted:pr,legend:mr,other:gr,attacker:hr,defender:br,magician:fr,supporter:yr,star:xr,name:kr,normal:wr,show:$r,bold:vr,search:qr,"show-content":"Inhalt","mercenary-type":"Art","mercenary-queue":"Queue","background-color":"Farbe","background-grid":"Gitter",reverse:Cr,"image-width":"Breite","image-width-custom":"Sitte:",reset:jr,queue:Nr,copylink:Sr,download:Tr,tip1:Rr,tip2:Dr,tip3:Ir,tip4:_r,tip5:Or,tip6:Er,"browser-mobile-alert":"Der Desktop ist besser als das Handy."},Fr="棕色塵埃 × 陣型分享",Mr="神話",zr="超越",Gr="傳說",Ur="其他",Ar="攻擊",Br="防禦",Pr="魔法",Hr="支援",Kr="星級",Wr="名稱",Qr="一般",Yr="顯示",Jr="粗體",Vr="請輸入關鍵字",Zr="圖片反向",Xr="重置",eo="順序",to="複製連結",ro="下載",oo="在列表中選擇傭兵，然後單擊陣型。或者拖曳頭像。",no="拖動網格中的僱傭兵以更改位置。",ao="右鍵傭兵可以設定技能強化等級。",so="雙擊或是拖曳至右側可以移除網格中的傭兵。",co="點擊[順序]按鈕來設置出手先後順序。",io="點擊[下載]取得圖片，或點擊[複製連結]取得網址。",lo={title:Fr,mythic:Mr,exalted:zr,legend:Gr,other:Ur,attacker:Ar,defender:Br,magician:Pr,supporter:Hr,star:Kr,name:Wr,normal:Qr,show:Yr,bold:Jr,search:Vr,"show-content":"顯示內容","mercenary-type":"傭兵類型","mercenary-queue":"出手順序","background-color":"背景顏色","background-grid":"背景方格",reverse:Zr,"image-width":"圖片寬度","image-width-custom":"自定義：",reset:Xr,queue:eo,copylink:to,download:ro,tip1:oo,tip2:no,tip3:ao,tip4:so,tip5:co,tip6:io,"browser-mobile-alert":"桌面瀏覽比手機更好。"},uo="棕色尘埃 × 阵型分享",po="神话",mo="超越",go="传说",ho="其他",bo="攻击",fo="防御",yo="魔法",xo="支援",ko="星级",wo="名称",$o="一般",vo="显示",qo="粗体",Co="请输入关键字",jo="图片反向",No="重置",So="顺序",To="复制连结",Ro="下载",Do="在列表中选择佣兵，然后单击阵型。或者拖曳头像。",Io="拖动网格中的僱佣兵以更改位置。",_o="右键佣兵可以设定技能强化等级。",Oo="双击或是拖曳至右侧可以移除网格中的佣兵。",Eo="点击[顺序]按钮来设置出手先后顺序。",Lo="点击[下载]取得图片，或点击[复制连结]取得网址。",Fo={title:uo,mythic:po,exalted:mo,legend:go,other:ho,attacker:bo,defender:fo,magician:yo,supporter:xo,star:ko,name:wo,normal:$o,show:vo,bold:qo,search:Co,"show-content":"显示内容","mercenary-type":"佣兵类型","mercenary-queue":"出手顺序","background-color":"背景颜色","background-grid":"背景方格",reverse:jo,"image-width":"图片宽度","image-width-custom":"自定义：",reset:No,queue:So,copylink:To,download:Ro,tip1:Do,tip2:Io,tip3:_o,tip4:Oo,tip5:Eo,tip6:Lo,"browser-mobile-alert":"桌面浏览比移动更好。"},Mo="形成 × 共有する",zo="神話",Go="超越",Uo="伝説",Ao="その他",Bo="攻撃",Po="防衛",Ho="魔法",Ko="サポート",Wo="星印",Qo="お名前",Yo="全般",Jo="ディスプレイ",Vo="太字",Zo="キーワードを入力してください",Xo="フリップ",en="リセットする",tn="キュー",rn="リンクをコピー",on="ダウンロードする",nn="アバターを選択し、フォーメーションをクリックします。",an="グリッド内の傭兵をドラッグして位置を変更します。",sn="右クリックでスキル強化レベルを設定できます。",cn="右側をダブルクリックまたはドラッグして削除します。",ln="ターンオーダーボタンをクリックして、優先順位を設定します。",dn="[ダウンロード]ボタンをクリックして画像を取得します。",un={title:Mo,mythic:zo,exalted:Go,legend:Uo,other:Ao,attacker:Bo,defender:Po,magician:Ho,supporter:Ko,star:Wo,name:Qo,normal:Yo,show:Jo,bold:Vo,search:Zo,"show-content":"画像内容","mercenary-type":"種類","mercenary-queue":"順序","background-color":"背景色","background-grid":"グリッド",reverse:Xo,"image-width":"画像の幅","image-width-custom":"カスタム：",reset:en,queue:tn,copylink:rn,download:on,tip1:nn,tip2:an,tip3:sn,tip4:cn,tip5:ln,tip6:dn,"browser-mobile-alert":"デスクトップはモバイルよりも優れています。"},pn="진형 × 순서",mn="신화",gn="초월",hn="전설",bn="기타",fn="공격",yn="방어",xn="마법",kn="지원",wn="별",$n="이름",vn="정상",qn="보기",Cn="진하게",jn="키워드를 입력하십시오",Nn="뒤집기",Sn="초기화",Tn="순서",Rn="링크 복사",Dn="다운로드",In="아바타를 선택하고 포메이션을 클릭하십시오.",_n="그곳에서 용병을 끌어서 위치를 변경하십시오.",On="마우스 오른쪽 버튼을 클릭하면 강화 수준을 설정할 수 있습니다.",En="더블 클릭하거나 드래그하여 제거하십시오.",Ln="우선 순위를 설정하려면 턴 오더 버튼을 클릭하십시오.",Fn="[다운로드] 버튼을 클릭하여 이미지를 가져옵니다.",Mn={title:pn,mythic:mn,exalted:gn,legend:hn,other:bn,attacker:fn,defender:yn,magician:xn,supporter:kn,star:wn,name:$n,normal:vn,show:qn,bold:Cn,search:jn,"show-content":"콘텐츠","mercenary-type":"유형","mercenary-queue":"큐","background-color":"배경색","background-grid":"그리드",reverse:Nn,"image-width":"너비","image-width-custom":"수동 :",reset:Sn,queue:Tn,copylink:Rn,download:Dn,tip1:In,tip2:_n,tip3:On,tip4:En,tip5:Ln,tip6:Fn,"browser-mobile-alert":"데스크탑은 모바일보다 낫습니다."},zn="ทหารรับจ้าง × หุ้น",Gn="ตำนาน",Un="เลิศล",An="ตำนาน",Bn="อื่นๆ",Pn="โจมตี",Hn="ป้องกัน",Kn="เวทมนตร์",Wn="สนับสนุน",Qn="ดาว",Yn="ชื่อ",Jn="ปกติ",Vn="แสดง",Zn="กล้า",Xn="กรุณาใส่คำค้นหา",ea="ย้อนกลับ",ta="ตั้งค่าใหม่",ra="เปิดคำสั่งซื้อ",oa="คัดลอกลิงค์",na="ดาวน์โหลด",aa="เลือกรายการทหารรับจ้างและคลิกที่รูปแบบ หรือเพียงแค่ลากและวาง",sa="ลากทหารรับจ้างในกริดเพื่อเปลี่ยนตำแหน่ง",ca="คลิกขวาสามารถกำหนดระดับการปรับปรุงทักษะ",ia="ดับเบิลคลิกหรือลากไปทางขวาเพื่อลบทหารรับจ้างในตาราง",la="คลิก [เปิดคำสั่งซื้อ] เพื่อตั้งค่าลำดับความสำคัญ",da="คลิก [ดาวน์โหลด] เพื่อรับภาพหรือ [คัดลอกลิงค์] รับลิงก์แชร์",ua={title:zn,mythic:Gn,exalted:Un,legend:An,other:Bn,attacker:Pn,defender:Hn,magician:Kn,supporter:Wn,star:Qn,name:Yn,normal:Jn,show:Vn,bold:Zn,search:Xn,"show-content":"เนื้อหา","mercenary-type":"ชนิด","mercenary-queue":"คิว","background-color":"สี","background-grid":"ตะแกรง",reverse:ea,"image-width":"ความกว้าง","image-width-custom":"กำหนดเอง:",reset:ta,queue:ra,copylink:oa,download:na,tip1:aa,tip2:sa,tip3:ca,tip4:ia,tip5:la,tip6:da,"browser-mobile-alert":"เดสก์ท็อปดีกว่ามือถือ"},oe={US:{label:"English",flagUrl:"https://flagcdn.com/us.svg",translation:Lt},ES:{label:"Español",flagUrl:"https://flagcdn.com/es.svg",translation:lr},DE:{label:"German",flagUrl:"https://flagcdn.com/de.svg",translation:Lr},TW:{label:"繁體中文",flagUrl:"https://flagcdn.com/tw.svg",translation:lo},CN:{label:"简体中文",flagUrl:"https://flagcdn.com/cn.svg",translation:Fo},JP:{label:"日本語",flagUrl:"https://flagcdn.com/jp.svg",translation:un},KR:{label:"한국어",flagUrl:"https://flagcdn.com/kr.svg",translation:Mn},TH:{label:"ไทย",flagUrl:"https://flagcdn.com/th.svg",translation:ua}},pa=H(Y("locale"))?"US":Y("locale");de.use(Fe).use(Ge).init({resources:oe,lng:pa,keySeparator:!1,interpolation:{escapeValue:!1}});const ma={list:[]},he=V({name:"characters",initialState:ma,reducers:{setCharacters(a,e){ue(e.payload)&&(a.list=e.payload)}}}),{setCharacters:ga}=he.actions,ha=he.reducer,ba={list:[]},be=V({name:"charactersGlobal",initialState:ba,reducers:{setCharactersGlobal(a,e){ue(e.payload)&&(a.list=e.payload)}}}),{setCharactersGlobal:fa}=be.actions,ya=be.reducer,xa=[{id:"a1",top:"9px",left:"11px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"a2",top:"9px",left:"125px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"a3",top:"9px",left:"239px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"a4",top:"9px",left:"354px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"a5",top:"9px",left:"468px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"a6",top:"9px",left:"582px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"b1",top:"123px",left:"11px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"b2",top:"123px",left:"126px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"b3",top:"123px",left:"240px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"b4",top:"123px",left:"354px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"b5",top:"123px",left:"468px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"b6",top:"123px",left:"582px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"c1",top:"238px",left:"12px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"c2",top:"238px",left:"126px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"c3",top:"238px",left:"240px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"c4",top:"238px",left:"354px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"c5",top:"238px",left:"468px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0},{id:"c6",top:"237px",left:"582px",type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0}],fe={formation:xa,options:{type:!0,backcolor:!0,backimage:!0,queue:!0,reverse:!1},ref:null,queueMode:!1,queueMax:12,queue:[],levelDialog:{show:!1,left:0,top:0,id:null},mercenarySelected:null},ka={...fe},ie=["type","backgroundImage","uniqueCode","queue","level"],ye=V({name:"dataset",initialState:ka,reducers:{setRef:(a,e)=>{a.ref=e.payload},setFormation:(a,e)=>{a.formation=e.payload},setLevelDialog:(a,e)=>{a.levelDialog=e.payload},setMercenarySelected:(a,e)=>{a.mercenarySelected=e.payload},setOptions:(a,e)=>{a.options=e.payload},setQueue:(a,e)=>{a.queue=e.payload},setQueueMode:(a,e)=>{a.queueMode=e.payload},reset(){return{...fe}}}}),{setRef:wa,setFormation:L,setLevelDialog:xe,setMercenarySelected:B,setOptions:$a,setQueue:ke,setQueueMode:le,reset:va}=ye.actions,qa=ye.reducer,we=V({name:"settings",initialState:{locale:Y("locale")===void 0?"US":Y("locale")},reducers:{setLocale(a,e){de.changeLanguage(e.payload),lt("locale",e.payload),a.locale=e.payload}}}),{setLocale:Ca}=we.actions,ja=we.reducer,Na=Ue({reducer:{characters:ha,charactersGlobal:ya,dataset:qa,settings:ja},middleware:a=>a().concat(Ae)}),Sa="https://api.browndust.info",Ta="https://browndust.info/resource/thumbnail",M="https://browndust.info/resource/icon",$e="https://book.browndust.app/detail.html?id=",Ra=async()=>fetch(Sa).then(a=>a.ok?a.json():console.warn("Change api url to github.")||fetch("https://raw.githubusercontent.com/explooosion/browndust-share/master/pre-work/getAll.json").then(e=>e.json())).catch(()=>console.warn("Change api url to github.")||fetch("https://raw.githubusercontent.com/explooosion/browndust-share/master/pre-work/getAll.json").then(a=>a.json())),Da=async()=>fetch("https://global-api.browndust.info").then(a=>a.ok?a.json():console.warn("Change global api url to github.")||fetch("https://raw.githubusercontent.com/explooosion/browndust-share/master/pre-work/global/getAll.json").then(e=>e.json())).catch(()=>console.warn("Change global api url to github.")||fetch("https://raw.githubusercontent.com/explooosion/browndust-share/master/pre-work/global/getAll.json").then(a=>a.json())),Ia=a=>{const e={backgroundColor:""};switch(a){case 1:e.backgroundColor=Q.yellow[800];break;case 2:e.backgroundColor=Q.indigo[800];break;case 3:e.backgroundColor=Q.violet[800];break;case 4:e.backgroundColor=Q.lime[800];break}return e},_a=a=>{const e={backgroundImage:""};switch(a){case 1:e.backgroundImage=`url(${M}/icon_charType__warrior.png)`;break;case 2:e.backgroundImage=`url(${M}/icon_charType__defender.png)`;break;case 3:e.backgroundImage=`url(${M}/icon_charType__magician.png)`;break;case 4:e.backgroundImage=`url(${M}/icon_charType__supporter.png)`;break}return e},Oa=a=>{const e={backgroundImage:""};switch(a){case 0:break;case 1:break;case 2:e.backgroundImage=`url(${M}/icon_charType__legend.png)`;break;case 3:e.backgroundImage=`url(${M}/icon_charType__warrior.png)`;break;case 4:e.backgroundImage=`url(${M}/icon_charType__defender.png)`;break;case 5:e.backgroundImage=`url(${M}/icon_charType__magician.png)`;break;case 6:e.backgroundImage=`url(${M}/icon_charType__supporter.png)`;break}return e},J=(a=!1)=>{if(!a)return null;const e=a.split("*")[1];return`${Ta}/${e}.png`},Ea=(a,e=null,c=e/2)=>new Promise(r=>{const o=document.createElement("img");o.onload=()=>{const n=document.createElement("canvas"),i=n.getContext("2d");e!==null&&(n.width=e),c!==null&&(n.height=c),i.drawImage(o,0,0,e,c);const p=n.toDataURL();r(p)},o.src=a,o.crossOrigin="use-credentials"}),La=(a=[],e=[])=>(window.location.hash.replace("#/","").split(".").filter(String).map(c=>{const r=c.split("o");if(r.shift(),r.length===0)return console.warn("Invalid url params.",c),r;const o=String(r[0]),n=a.find(({id:g})=>g===String(r[0]));if(H(n))return console.warn("Invalid url param: id",o),r;const i=String(r[1]),p=e.find(({_uniqueCode:g})=>String(g)===i);if(H(p))return console.warn("Invalid url params: uniqueCode",i),r;const h=Number(p._type),u=`url(${J(p._uiIconImageName)})`,w=Number(r[2])>0&&Number(r[2])<=12?Number(r[2]):0;let l=Number(r[3])>15||Number(r[3])<1?0:Number(r[3]);return l=isNaN(l)?0:l,{id:o,uniqueCode:i,type:h,backgroundImage:u,queue:w,level:l}}).forEach(c=>{const r=a.findIndex(o=>o.id===c.id);r!==-1&&(a[r]={...a[r],...c},console.info("Received data:",c.id,c.uniqueCode))}),a),ve=d.memo(function({selected:e,onSelect:c}){const[r,o]=d.useState(!1),[n,i]=d.useState({}),p=d.useRef(null),h=l=>{c(l),o(!1)},u=oe[e];d.useEffect(()=>{const l=g=>{p.current&&!p.current.contains(g.target)&&o(!1)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[p]);const w=l=>{i(g=>({...g,[l]:!0}))};return t.jsxs("div",{ref:p,className:"z-50 relative inline-block text-left",children:[t.jsx("div",{children:t.jsxs("button",{type:"button",className:"flex justify-center items-center w-full rounded-md border border-gray-600 shadow-sm px-4 py-2 bg-gray-800 text-sm font-medium text-white outline-none",id:"menu-button","aria-expanded":"true","aria-haspopup":"true",onClick:()=>o(!r),children:[t.jsx("img",{src:u.flagUrl,alt:u.label,className:"inline-block w-6 h-auto mr-2"}),u.label,t.jsx("svg",{className:"-mr-1 ml-2 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:t.jsx("path",{fillRule:"evenodd",d:"M5.23 7.21a.75.75 0 011.06.02L10 10.44l3.71-3.21a.75.75 0 111.02 1.08l-4 3.5a.75.75 0 01-1.02 0l-4-3.5a.75.75 0 01.02-1.06z",clipRule:"evenodd"})})]})}),r&&t.jsx("div",{className:"origin-top-left absolute mt-2 w-44 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 overflow-y-auto max-h-60",role:"menu","aria-orientation":"vertical","aria-labelledby":"menu-button",tabIndex:"-1",children:t.jsx("div",{className:"py-1",role:"none",children:Object.entries(oe).map(([l,{label:g,flagUrl:C}])=>t.jsxs("button",{onClick:()=>h(l),className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100 w-full text-left text-sm",role:"menuitem",tabIndex:"-1",children:[!n[l]&&t.jsx("div",{className:"inline-block w-6 h-6 mr-2 bg-gray-200 animate-pulse"}),t.jsx("img",{src:C,alt:g,className:`inline-block w-6 h-auto mr-2 ${n[l]?"":"hidden"}`,onLoad:()=>w(l)}),g]},l))})})]})});ve.propTypes={selected:s.string.isRequired,onSelect:s.func.isRequired};const Fa=d.memo(function(){const{t:e}=F(),c=z(),{locale:r}=D(n=>n.settings,U),o=n=>{c(Ca(n))};return t.jsx("header",{className:"text-2xl",children:t.jsxs("div",{className:"relative flex justify-center items-center text-center lg:text-left",children:[t.jsx("h1",{children:t.jsxs("a",{href:"https://browndust.info/#/",className:"block text-yellow-500 no-underline text-4xl font-bold text-center",children:["BROWNDUST"," ",t.jsx("small",{className:"hidden sm:inline",children:e("title")})]})}),t.jsx("div",{className:"absolute top-0 left-2.5 font-sans text-gray-800",children:t.jsx(ve,{selected:r,onSelect:o})})]})})}),qe=d.memo(function({id:e,left:c,top:r,mode:o}){const{t:n}=F(),i=z(),[p,h]=d.useState(0),{formation:u,levelDialog:w}=D(y=>({formation:y.dataset.formation,levelDialog:y.dataset.levelDialog}),U),l=y=>{if(H(y)||p>15||p<0)return;const j={levelDialog:w,formation:u};j.formation=u.map(v=>v.uniqueCode===y?{...v,level:p}:v),j.levelDialog={show:!1,id:null,left:0,top:0},i(xe(j.levelDialog)),i(L(j.formation))},g=y=>t.jsxs("div",{className:"w-[150px]",children:[t.jsx("h3",{className:"font-bold text-center text-gray-200 mb-2",children:n("Level")}),t.jsx("hr",{}),t.jsx("input",{type:"number",min:0,max:15,value:p,onChange:j=>h(j.target.value),onFocus:j=>j.target.select(),className:"w-full p-1 text-black",autoFocus:!0}),t.jsx("button",{type:"button",onClick:()=>l(y),className:"float-right mt-2 mb-1 w-16 h-6 text-lg text-black bg-gray-300 hover:bg-gray-200 rounded outline-none  active:bg-white",children:"OK"})]});let C=null;switch(o){case"level":C=g(e);break;default:C=null}return t.jsx("div",{id:"dialog",className:"absolute p-1.5 w-30 bg-gray-800 bg-opacity-95 border-4 border-gray-400 border-opacity-95 rounded-lg z-50",style:{left:`${c}px`,top:`${r-60}px`},children:C})});qe.propTypes={id:s.number,top:s.number.isRequired,left:s.number.isRequired,mode:s.string.isRequired};const Ma=d.memo(function(){const e=z(),{formation:c,levelDialog:r,characters:o}=D(u=>({formation:u.dataset.formation,levelDialog:u.dataset.levelDialog,characters:u.characters.list}),U),n=d.useCallback(({props:u})=>{const{uniqueCode:w}=c.find(g=>g.uniqueCode===u.uniqueCode),{_uniqueCode:l}=o.find(g=>g._uniqueCode===w);window.open($e+l,"_blank")},[c,o]),i=d.useCallback(({event:u,props:w})=>{const l={...r,show:!0,left:u.clientX-50,top:u.clientY-50,id:w.uniqueCode};e(xe(l))},[r,e]),p=d.useCallback(({props:u})=>{const w=c.map(l=>l.uniqueCode===u.uniqueCode?{...l,level:0}:l);e(L(w))},[c,e]),h=d.useCallback(({id:u,event:w,props:l})=>{({"ctmenu-item-link":n,"ctmenu-item-addLevel":i,"ctmenu-item-clearAll":p})[u]({event:w,props:l})},[n,i,p]);return t.jsxs(Pe,{id:"ctmenu",animation:"flip",className:"react-contexify w-56 bg-white rounded-lg shadow-lg",children:[t.jsxs(te,{id:"ctmenu-item-link",onClick:h,className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100",children:[t.jsx(We,{className:"mr-2"}),"Mercenary Info"]}),t.jsxs(te,{id:"ctmenu-item-addLevel",onClick:h,className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100",children:[t.jsx(Qe,{className:"mr-2"}),"Add Level"]}),t.jsx(He,{className:"my-2 border-t border-gray-200"}),t.jsxs(te,{id:"ctmenu-item-clearAll",onClick:h,className:"flex items-center px-4 py-2 text-gray-700 hover:bg-gray-100",children:[t.jsx(Ye,{className:"mr-2"}),"Clear Settings"]})]})}),za=d.memo(function(){const e=z(),{ref:c,characters:r,options:o,formation:n,levelDialog:i,queue:p,queueMode:h,mercenarySelected:u}=D(b=>({ref:b.dataset.ref,characters:b.characters.list,options:b.dataset.options,formation:b.dataset.formation,levelDialog:b.dataset.levelDialog,queue:b.dataset.queue,queueMode:b.dataset.queueMode,mercenarySelected:b.dataset.mercenarySelected}),U),{show:w}=Ke({id:"ctmenu"}),{type:l,backcolor:g,backimage:C,queue:y,reverse:j}=o,v=b=>{if(h)return;const k=n.map(f=>f.id===b?{...f,uniqueCode:0,backgroundImage:null,type:0,queue:0,level:0}:f);e(L(k))},I=(b,k)=>{let f=!1;const T=n.map(m=>m.id===b?(m.dragOver!==k&&(f=!0),{...m,dragOver:k}):m);f&&e(L(T))},x=(b,k)=>{b.preventDefault(),n.find(f=>k&&f.uniqueCode===k)&&w({event:b,props:{uniqueCode:k}})},O=b=>{const k=n.find(m=>m.id===b);if(k.uniqueCode&&h){const m={formation:[...n],queue:[...p]};let N=1;const S=m.queue.findIndex(q=>q.id===b);S>-1?m.queue=m.queue.filter(q=>q.id!==b):(m.queue.length>0&&(N=m.queue.length+1),m.queue.push({id:b,queue:N})),m.formation=m.formation.map(q=>q.id===b?{...q,queue:q.queue===0?N:0}:q),S>-1&&(m.queue=m.queue.map((q,$)=>({...q,queue:$+1}))),m.formation=m.formation.map(q=>{var $;if(q.queue>0){const A=(($=m.queue.find(_=>_.id===q.id))==null?void 0:$.queue)||0;return{...q,queue:A}}return q}),e(ke(m.queue)),e(L(m.formation))}const f=n.find(m=>m.uniqueCode===u);let T=[...n];if(f)T=n.map(m=>m.id===k.id?{...m,...ce(f,ie)}:m.id===f.id?{...m,...ce(k,ie)}:m);else{const m=r.find(({_uniqueCode:S})=>S===u);if(!m){e(B(null));return}const N=`
            url(${J(m._uiIconImageName)})`;T=T.map(S=>S.id===k.id?{...S,backgroundImage:N,type:Number(m._type),uniqueCode:m._uniqueCode,dragOver:!1}:S)}e(L(T)),e(B(null))},G=(b,k,f)=>{b.dataTransfer.setData("suCode",k),b.dataTransfer.setData("sid",f)},R=b=>{b.preventDefault()},K=(b,k)=>{b.preventDefault(),I(k,!0)},W=(b,k)=>{b.preventDefault(),I(k,!1)},Z=(b,k)=>{let f=[...n];const T=b.dataTransfer.getData("sid"),m=Number(b.dataTransfer.getData("suCode")),N=n.find($=>$.id===k),S=n.find($=>$.id===T),q=r.find(({_uniqueCode:$})=>$===m);if(m===N.uniqueCode||!q){f=f.map($=>$.id===N.id?{...$,dragOver:!1}:$),e(L(f)),e(B(null));return}if(S&&N.uniqueCode&&S.uniqueCode!==N.uniqueCode)f=f.map($=>$.id===N.id?{...$,dragOver:!1,uniqueCode:S.uniqueCode,backgroundImage:S.backgroundImage,type:S.type,queue:S.queue,level:S.level}:$.id===S.id?{...$,dragOver:!1,uniqueCode:N.uniqueCode,backgroundImage:N.backgroundImage,type:N.type,queue:N.queue,level:N.level}:$);else{const $=f.find(_=>_.uniqueCode===m),A=`
            url(${J(q._uiIconImageName)})`;f=f.map(_=>$&&_.id===$.id?{..._,dragOver:!1,uniqueCode:0,backgroundImage:null,type:0,queue:0,level:0}:_.id===N.id?{...N,backgroundImage:A,type:Number(q._type),uniqueCode:m,dragOver:!1}:_)}e(L(f)),e(B(null))},X=b=>{b.preventDefault()},ee=(b,k)=>n.map(({id:f,top:T,left:m,type:N,backgroundImage:S,uniqueCode:q,dragOver:$,queue:A,level:_})=>{const se=q>0;return t.jsxs("div",{className:`absolute w-[6.5rem] h-[6.5rem] bg-center bg-no-repeat bg-cover ${$?"bg-[rgba(200,200,255,0.3)] border border-yellow-500":""} ${se?"cursor-pointer":""}`,draggable:se,style:{top:T,left:m,backgroundImage:S,...g?Ia(N):{},...j?{transform:"rotateY(180deg)"}:{}},onClick:()=>O(f),onDoubleClick:()=>v(f),onContextMenu:E=>x(E,q),onDragStart:E=>G(E,q,f),onDragOver:R,onDragEnter:E=>K(E,f),onDragLeave:E=>W(E,f),onDrop:E=>Z(E,f),onDragEnd:E=>X(E),children:[b?t.jsx("div",{className:"absolute top-0 right-0 w-9 h-9 bg-center bg-no-repeat",style:{..._a(N)}}):null,k&&A>0?t.jsx("div",{className:"absolute top-0 left-0 flex items-center justify-center w-9 h-9 text-yellow-400 bg-black bg-opacity-50",children:A}):null,_>0?t.jsx("div",{className:"absolute bottom-1 left-1 flex justify-center items-center text-center w-12 text-white bg-blue-700 bg-opacity-70 rounded-full font-bold italic",style:{...j?{transform:"rotateY(180deg)"}:{}},children:_&&`+${_}`}):null]},`formation-${f}`)});return d.useEffect(()=>{e(wa("formation"))},[]),t.jsxs("div",{id:c,className:`relative w-[700px] h-[350px] bg-center bg-cover bg-[#17293C] rounded border border-transparent ${C?"bg-[url('images/formation_background.jpg')]":"bg-none"}`,children:[ee(l,y),t.jsx(Ma,{}),i.show?t.jsx(qe,{...i,mode:"level"}):null]})}),Ce=d.memo(function({currentType:e,setCurrentType:c}){const{t:r}=F(),o=[{type:null,filterType:0,growType:4,label:r("mythic")},{type:null,filterType:1,growType:3,label:r("exalted")},{type:null,filterType:2,growType:2,label:r("legend")},{type:1,filterType:3,growType:1,label:r("attacker")},{type:2,filterType:4,growType:1,label:r("defender")},{type:3,filterType:5,growType:1,label:r("magician")},{type:4,filterType:6,growType:1,label:r("supporter")},{type:null,filterType:7,growType:1,label:r("other")}];return t.jsx("div",{className:"flex items-center justify-between",children:o.map(n=>t.jsx(je,{typeObj:n,isActive:n.filterType===e.filterType,setCurrentType:c},`type-${n.type}-${n.filterType}-${n.growType}`))})}),je=({typeObj:a,isActive:e,setCurrentType:c})=>{const{type:r,filterType:o,growType:n,label:i}=a;return t.jsxs("button",{type:"button",className:`flex justify-center items-center w-20 h-11 text-white border border-gray-500 rounded shadow space-x-1 ${e?"bg-blue-500":"bg-gray-700"}`,onClick:()=>c({type:r,filterType:o,growType:n,label:i}),children:[[2,3,4,5,6].includes(o)&&t.jsx("i",{className:"w-7 h-7 bg-center bg-no-repeat bg-cover",style:Oa(o)}),t.jsx("span",{className:"text-xs",children:i})]})};je.propTypes={typeObj:s.shape({type:s.number,filterType:s.number.isRequired,growType:s.number.isRequired,label:s.string}).isRequired,isActive:s.bool.isRequired,setCurrentType:s.func.isRequired};Ce.propTypes={currentType:s.shape({filterType:s.number.isRequired,type:s.number,growType:s.number.isRequired,label:s.string}).isRequired,setCurrentType:s.func.isRequired};const Ne=d.memo(function(e){const{stars:c,setStars:r}=e,{t:o}=F(),n=p=>{r(h=>h.map(u=>u.label===p?{...u,checked:!u.checked}:u))},i=()=>c.map(({label:p,checked:h},u)=>t.jsx("div",{children:t.jsx(ae,{shape:"round",color:"info",animation:"jelly",icon:t.jsx("i",{className:"mdi mdi-check"}),checked:h,onChange:()=>n(p),children:t.jsx("span",{children:p})})},`star-${u}`));return t.jsxs("div",{className:"flex items-center text-md",children:[t.jsxs("div",{className:"flex justify-center items-center space-x-1",children:[t.jsx(Je,{}),t.jsxs("span",{children:[o("star"),"："]})]}),i()]})});Ne.propTypes={stars:s.arrayOf(s.shape({label:s.string.isRequired,checked:s.bool.isRequired,star:s.number.isRequired})).isRequired,setStars:s.func.isRequired};const Se=d.memo(function({nameOptions:e,setNameOptions:c}){const{t:r}=F(),o=i=>{c(p=>p.map(h=>h.label===i?{...h,checked:!h.checked}:h))},n=()=>e.map(({label:i,checked:p},h)=>t.jsx("div",{children:t.jsx(ae,{shape:"round",color:"info",animation:"jelly",icon:t.jsx("i",{className:"mdi mdi-check"}),checked:p,onChange:()=>o(i),children:t.jsx("span",{children:i})})},`name-${h}`));return t.jsxs("div",{className:"flex items-center text-sm",children:[t.jsxs("span",{children:[r("name"),"："]}),n()]})});Se.propTypes={nameOptions:s.arrayOf(s.shape({label:s.string.isRequired,checked:s.bool.isRequired})).isRequired,setNameOptions:s.func.isRequired};const Te=d.memo(function(e){const{search:c,setSearch:r}=e,{t:o}=F();return t.jsx("input",{className:"w-full p-2 text-md bg-gray-800 border border-gray-600 rounded",type:"text",placeholder:o("search"),value:c,onChange:n=>r(n.target.value)})});Te.propTypes={search:s.string.isRequired,setSearch:s.func.isRequired};const Re=d.memo(function({params:e,nameOptions:c}){const r=z(),o=D(x=>x.settings),n=D(x=>x.dataset.formation),i=D(x=>x.dataset.mercenarySelected),p=D(x=>x.charactersGlobal.list),{_uiIconImageName:h,_uniqueCode:u}=e,w=c.map(x=>x.checked),l=J(h),g=H(n.find(x=>x.uniqueCode===u))?1:.2,C=d.useCallback((x,O,G)=>{x.dataTransfer.setData("suCode",O),x.dataTransfer.setData("sid",G)},[]),y=d.useCallback(x=>{window.open($e+x,"_blank")},[]),j=d.useCallback(x=>{r(B(i===x?null:x))},[r,i]),v=d.useCallback((x,O)=>{if(pe(O))return"";const{_uniqueCode:G,_charName:R,_charName_ENG:K,_charName_TW:W,_charName_JAP:Z,_charName_SPA:X,_charName_GER:ee,_charName_TH:b}=O,k={US:K,ES:X,DE:ee,TW:W,CN:re.sify(W),JP:Z,KR:R,TH:b};let f=k[x]||K;const T=p.find(m=>m._uniqueCode===G);return T&&(f=k[x]||T._charName),Me(f)?T==null?void 0:T._charName:f},[p]),I=d.useMemo(()=>v(o.locale,e),[o.locale,e,v]);return t.jsx("div",{className:`relative w-16 h-16 bg-center bg-no-repeat bg-cover border border-gray-400 rounded transition-all ease-in-out duration-100 cursor-pointer text-xs m-2 ${w[0]?"before:block":"before:hidden"} ${w[1]?"before:font-bold":""} ${i===u&&g===1?"border-red-500":""} before:content-[attr(data-tooltip)]`,draggable:!0,style:{backgroundImage:`url(${l})`,opacity:g},"data-tooltip":I,onClick:()=>j(u),onDragStart:x=>C(x,u,0),onDoubleClick:()=>y(u)})});Re.propTypes={nameOptions:s.arrayOf(s.shape({label:s.string.isRequired,checked:s.bool.isRequired})).isRequired,params:s.shape({_uiIconImageName:s.string.isRequired,_uniqueCode:s.number.isRequired}).isRequired};const De=d.memo(function(e){const{search:c,stars:r,currentType:o,nameOptions:n}=e,i=D(l=>l.characters.list),{charactersGlobal:p,settings:h}=D(l=>({charactersGlobal:l.charactersGlobal.list,settings:l.settings}),U),u=(l="",g)=>l===""?g:p.filter(C=>{const{_charName:y,_charName_ENG:j,_charName_TW:v,_charName_JAP:I,_charName_SPA:x,_charName_GER:O,_charName_TH:G}=C;let R=!1;switch(h.locale){case"US":R=j.includes(l);break;case"ES":R=x.includes(l);break;case"DE":R=O.includes(l);break;case"TW":R=v.includes(l)||re.sify(v).includes(l);break;case"CN":R=v.includes(l)||re.sify(v).includes(l);break;case"JP":R=I.includes(l);break;case"KR":R=y.includes(l);break;case"TH":R=G.includes(l);break;default:R=!0}return R}),w=l=>u(c,l).filter(g=>{const{_type:C,_star:y,_filterType:j}=g;if(c.trim().length>0)return!0;const v=I=>r.some((x,O)=>x.checked&&Number(I)===6-O);return pe(o.type)?o.filterType===Number(j)&&v(y):ze(o.type)&&o.type===Number(C)&&v(y)}).map((g,C)=>t.jsx(Re,{params:g,nameOptions:n},`mercenary-${C}`));return t.jsx("div",{className:"overflow-y-scroll h-[calc(100vh-320px)] flex flex-wrap content-start",children:i.length===0?t.jsx(st,{color:"#5ac0de",size:100}):w(i)})});De.propTypes={search:s.string.isRequired,stars:s.arrayOf(s.shape({label:s.string,checked:s.bool.isRequired,star:s.number.isRequired})).isRequired,currentType:s.shape({filterType:s.number.isRequired,type:s.number,growType:s.number.isRequired,label:s.string}).isRequired,nameOptions:s.arrayOf(s.shape({label:s.string.isRequired,checked:s.bool.isRequired})).isRequired};const Ga=d.memo(function(){const{t:e}=F(),c=z(),[r,o]=d.useState(""),[n,i]=d.useState({type:1,filterType:3,growType:1,label:e("attacker")}),[p,h]=d.useState([{label:"6",checked:!0,star:6},{label:"5",checked:!0,star:5},{label:"4",checked:!1,star:4},{label:"3",checked:!1,star:3},{label:"2",checked:!1,star:2},{label:"1",checked:!1,star:1}]),[u,w]=d.useState([{label:e("show"),checked:!0},{label:e("bold"),checked:!1}]),l=D(y=>y.dataset.formation);d.useEffect(()=>{w(y=>[{...y[0],label:e("show")},{...y[1],label:e("bold")}])},[e]);const g=y=>{const j=y.dataTransfer.getData("sid");if(j==="0")return;const v=l.map(I=>j!==I.id?I:{...I,type:0,backgroundImage:null,uniqueCode:0,dragOver:!1,queue:0,level:0});c(L(v))},C=y=>{y.preventDefault()};return t.jsxs("div",{className:"w-1/2 min-w-[760px] p-4 bg-black bg-opacity-30 rounded space-y-4",onDragOver:C,onDrop:g,children:[t.jsx(Ce,{currentType:n,setCurrentType:i}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx(Ne,{stars:p,setStars:h}),t.jsx(Se,{nameOptions:u,setNameOptions:w})]}),t.jsx(Te,{search:r,setSearch:o}),t.jsx(De,{search:r,stars:p,currentType:n,nameOptions:u})]})}),Ie=d.memo(function({optionKey:e,label:c}){const r=z(),o=D(i=>i.dataset.options,U),n=d.useCallback(i=>{r($a({...o,...i}))},[r,o]);return t.jsx(ae,{shape:"round",color:"info",animation:"jelly",icon:t.jsx("i",{className:"mdi mdi-check"}),checked:o[e],onChange:i=>n({[e]:i.target.checked}),children:c})});Ie.propTypes={optionKey:s.string.isRequired,label:s.string.isRequired};const Ua={type:"mercenary-type",queue:"mercenary-queue",backcolor:"background-color",backimage:"background-grid",reverse:"reverse"},Aa=d.memo(function(){const{t:e}=F(),c=d.useCallback(()=>Object.entries(Ua).map(([r,o])=>t.jsx(Ie,{optionKey:r,label:e(o)},r)),[]);return t.jsxs("div",{children:[t.jsxs("span",{children:[e("show-content"),"："]}),c()]})}),_e=d.memo(function(e){const{downloadSizeSelected:c,setDownloadSizeSelected:r,downloadSizeCustom:o,setDownloadSizeCustom:n}=e,{t:i}=F();d.useEffect(()=>{new ge(".tool-copylink")},[]);const p=[{value:1,name:700},{value:2,name:520},{value:3,name:420},{value:4,name:i("image-width-custom")}];return t.jsxs("div",{children:[t.jsxs("span",{children:[i("image-width"),"："]}),p.map(({value:h,name:u})=>t.jsx(at,{name:"download-size",shape:"round",color:"info",animation:"jelly",icon:t.jsx("i",{className:"mdi mdi-check"}),value:h,checked:h===c,onChange:()=>r(h),children:h!==4?`${u}px`:u},`download-size-${h}`)),t.jsx("input",{type:"number",min:0,max:2e3,className:"p-1 w-16 h-6 text-white bg-gray-800 border border-gray-600 rounded",value:o,onChange:h=>n(h.target.value.replace(/\D/,"")),onFocus:()=>r(4)})," ","px"]})});_e.propTypes={downloadSizeSelected:s.number.isRequired,setDownloadSizeSelected:s.func.isRequired,downloadSizeCustom:s.number.isRequired,setDownloadSizeCustom:s.func.isRequired};const Ba=[{value:1,name:700},{value:2,name:520},{value:3,name:420},{value:4,name:"image-width-custom"}],Oe=d.memo(function({downloadSizeSelected:e,downloadSizeCustom:c}){const r=z(),{t:o}=F(),{formation:n,queueMode:i,ref:p}=D(g=>({formation:g.dataset.formation,queueMode:g.dataset.queueMode,ref:g.dataset.ref}),U);d.useEffect(()=>{new ge(".tool-copylink")},[]);const h=d.useCallback(()=>{if(i)r(ke([])),r(le(!1));else{const g=n.map(C=>({...C,queue:0}));r(L(g)),r(le(!0))}},[r,n,i]),u=d.useCallback(async()=>{var C;const g=e!==4?(C=Ba.find(y=>y.value===e))==null?void 0:C.name:Number(c);if(!(Number(g)<=0))try{const y=await ct(document.getElementById(p),{skipFonts:!0}),j=await Ea(y,g),v=document.createElement("a");v.href=j,v.download=`output-${it().format("YYYYMMDDTHmmss")}.png`,document.body.appendChild(v),v.click(),document.body.removeChild(v)}catch(y){console.error("Download error:",y)}},[e,c,p]),w=d.useCallback(()=>{r(va())},[r]),l=n.filter(g=>g.queue>0).length;return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs(P,{onClick:w,color:"gray",children:[t.jsx(Ve,{size:"2em",color:"#fff"}),t.jsx("span",{children:o("reset")})]}),t.jsx(P,{onClick:h,color:i?"red-light":"red-dark",children:i?t.jsx(ne,{icon:t.jsx(Ze,{size:"2em",color:"#fff"}),label:`${o("queue")}(${l})`}):t.jsx(ne,{icon:t.jsx(Xe,{size:"2em",color:"#fff"}),label:`${o("queue")}(${l})`})}),t.jsxs(P,{onClick:u,color:"blue",children:[t.jsx(et,{size:"2em",color:"#fff"}),t.jsx("span",{children:o("download")})]})]}),t.jsxs("div",{className:"flex space-x-4",children:[t.jsx("input",{id:"tool-copylink-text",className:"flex-grow p-1 text-md text-gray-400 bg-gray-900 border border-gray-600 rounded",value:window.location.href,readOnly:!0}),t.jsxs(P,{className:"tool-copylink",color:"green",dataClipboardTarget:"#tool-copylink-text",onClick:()=>{},children:[t.jsx(tt,{size:"1.5em",color:"#fff"}),t.jsx("span",{children:o("copylink")})]})]})]})}),P=d.memo(function({children:e,onClick:c,color:r,className:o,dataClipboardTarget:n}){const i="flex items-center justify-around w-36 h-10 border text-white rounded shadow",p={gray:"bg-gray-800 hover:bg-gray-700 active:bg-gray-600 border-gray-600","red-light":"bg-red-400 active:bg-red-600 border-red-600","red-dark":"bg-red-700 active:bg-red-600 border-red-600",blue:"bg-blue-600 hover:bg-blue-500 active:bg-blue-400 border-blue-400",green:"bg-green-600 border-green-400"};return t.jsx("button",{type:"button",className:`${i} ${p[r]} ${o||""}`,onClick:c,"data-clipboard-target":n,children:e})}),ne=d.memo(function({icon:e,label:c}){return t.jsxs("div",{className:"flex items-center justify-around w-full",children:[e,t.jsx("span",{children:c})]})});P.propTypes={children:s.node.isRequired,onClick:s.func.isRequired,color:s.oneOf(["gray","red-light","red-dark","blue","green"]).isRequired,className:s.string,dataClipboardTarget:s.string};ne.propTypes={icon:s.node.isRequired,label:s.string.isRequired};Oe.propTypes={downloadSizeSelected:s.number.isRequired,downloadSizeCustom:s.number.isRequired};const Pa=d.memo(function(){const[e,c]=d.useState(1),[r,o]=d.useState(0);return t.jsxs("div",{className:"flex flex-col p-4 bg-black bg-opacity-30 rounded space-y-4",children:[t.jsx(Aa,{}),t.jsx(_e,{downloadSizeSelected:e,setDownloadSizeSelected:c,downloadSizeCustom:r,setDownloadSizeCustom:o}),t.jsx(Oe,{downloadSizeSelected:e,downloadSizeCustom:r})]})}),Ha=d.memo(function(){const[e,c]=d.useState(!1),{t:r}=F(),o=()=>{c(n=>!n)};return t.jsxs("footer",{className:"relative flex flex-col justify-start p-3",children:[t.jsxs("div",{className:"flex items-center select-none cursor-pointer",children:[t.jsx("a",{className:"footer-link mr-3 text-white hover:text-yellow-300",title:"GitHub",href:"https://github.com/explooosion/browndust-share",target:"_blank",rel:"noopener noreferrer",children:t.jsx(rt,{size:"2em"})}),t.jsx("a",{className:"footer-link mr-3 text-white hover:text-yellow-300",title:"Issue",href:"https://github.com/explooosion/browndust-share/issues",target:"_blank",rel:"noopener noreferrer",children:t.jsx(ot,{size:"2.3em"})}),t.jsx("span",{className:"footer-link mr-3 text-white hover:text-yellow-300",onClick:o,children:t.jsx(nt,{size:"2.3em"})})]}),t.jsx("div",{className:`absolute top-[-11rem] left-[9rem] mt-3 p-3 text-white bg-gray-900 border border-yellow-500 rounded-md transition-opacity duration-200 ease-in-out ${e?"opacity-100 visible":"opacity-0 invisible"}`,children:Array.from({length:6},(n,i)=>t.jsxs("span",{className:"block text-lg tracking-wider",children:[i+1,". ",r(`tip${i+1}`)]},i))}),t.jsx("span",{className:"fixed bottom-5 left-5 text-sm text-gray-400 hidden lg:block",children:"This site is fan-made and not affiliated with NEOWIZ and GAMFS in any way."})]})}),Ka=d.memo(function(){const e=z(),c=D(r=>r.dataset.formation);return d.useEffect(()=>{(async()=>{try{const[o,n]=await Promise.all([Da(),Ra()]);e(fa(o)),e(ga(n)),e(L(La(c,n)))}catch(o){console.error("Error fetching data:",o)}})()},[]),t.jsx(Be,{children:t.jsx("main",{className:"p-4",children:t.jsxs("div",{className:"mx-auto max-w-[1550px]",children:[t.jsx(Fa,{}),t.jsxs("section",{className:"flex-col md:flex-row flex items-start justify-around py-5 px-2 md:px-0",children:[t.jsxs("section",{className:"space-y-4",children:[t.jsx(za,{}),t.jsx(Pa,{}),t.jsx(Ha,{})]}),t.jsx(Ga,{})]})]})})})}),Wa=document.getElementById("root");Ee.createRoot(Wa).render(t.jsx(Le,{store:Na,children:t.jsx(Ka,{})}));
